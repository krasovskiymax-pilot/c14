# Схема базы данных ChatList

База данных: **SQLite**

---

## Таблица `prompts` — Промты (запросы)

Хранит тексты запросов, отправляемых в нейросети.

| Поле    | Тип        | Описание                          |
|---------|------------|-----------------------------------|
| id      | INTEGER    | Первичный ключ, автоинкремент     |
| created | DATETIME   | Дата и время создания записи      |
| text    | TEXT       | Текст промта                      |
| tags    | TEXT       | Теги (разделённые запятой или JSON) |

**Индексы:** `created`, `tags` (при необходимости поиска по тегам)

---

## Таблица `models` — Нейросети

Хранит настройки подключения к API нейросетей. API-ключи хранятся в `.env`, в таблице — имя переменной окружения.

| Поле     | Тип      | Описание                                           |
|----------|----------|----------------------------------------------------|
| id       | INTEGER  | Первичный ключ, автоинкремент                     |
| name     | TEXT     | Название модели (отображается пользователю)       |
| api_url  | TEXT     | URL эндпоинта API                                  |
| api_id   | TEXT     | Имя переменной в `.env`, где хранится API-ключ     |
| is_active| INTEGER  | 1 — активна, 0 — не участвует в запросах           |

**Ограничения:** `api_id` — UNIQUE (одна переменная на модель)

---

## Таблица `results` — Сохранённые результаты

Хранит ответы моделей, отмеченные пользователем для сохранения.

| Поле      | Тип      | Описание                                       |
|-----------|----------|------------------------------------------------|
| id        | INTEGER  | Первичный ключ, автоинкремент                 |
| prompt_id | INTEGER  | Ссылка на prompts.id                           |
| model_id  | INTEGER  | Ссылка на models.id                            |
| response  | TEXT     | Текст ответа нейросети                         |
| created   | DATETIME | Дата и время сохранения                        |

**Внешние ключи:**
- `prompt_id` → `prompts(id)` (ON DELETE CASCADE или SET NULL — по решению)
- `model_id` → `models(id)`

**Индексы:** `prompt_id`, `model_id`, `created`

---

## Таблица `settings` — Настройки программы

Хранит пары ключ-значение для настроек приложения.

| Поле   | Тип     | Описание                    |
|--------|---------|-----------------------------|
| key    | TEXT    | Ключ настройки (PRIMARY KEY)|
| value  | TEXT    | Значение настройки          |

**Примеры ключей:**
- `last_prompt_id` — последний выбранный промт
- `theme` — тема интерфейса
- `export_path` — путь по умолчанию для экспорта

---

## Временная таблица (в памяти, не в SQLite)

Используется только во время сеанса. Не сохраняется в БД.

| Поле     | Тип    | Описание                              |
|----------|--------|---------------------------------------|
| model_id | INTEGER| id модели                             |
| model_name| TEXT  | Название модели (для отображения)     |
| response | TEXT   | Текст ответа                          |
| selected | BOOLEAN| Отмечено ли пользователем для сохранения |

Реализуется как список словарей или dataclass в Python.

---

## Диаграмма связей (ER)

```
prompts (1) ───────────< results (N)
    │                         │
    │                         │
    └─────────────────────────┼──────> models (1) ──< results (N)

settings — изолированная таблица (key-value)
```

---

## .env — переменные окружения

Файл не входит в БД. Пример структуры:

```
# Имена переменных соответствуют значениям models.api_id
OPENAI_API_KEY=sk-...
DEEPSEEK_API_KEY=...
GROQ_API_KEY=...
```
